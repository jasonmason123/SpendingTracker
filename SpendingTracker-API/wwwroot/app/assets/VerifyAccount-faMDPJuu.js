import{r as n,u as f,a as p,j as e,A as g,P as b}from"./index-DvfJ_ynl.js";import{P as y,A as j}from"./PublicRoute-CXzmJ905.js";import{I as v}from"./InputField--cIt_x2f.js";function w(){const[r,m]=n.useState(""),{key:i}=f(),u=p(),[c,o]=n.useState(null),[l,a]=n.useState(!1),h=async()=>{try{a(!0);const t=await fetch(`/api/resend/${i}`,{method:"GET",credentials:"include"});if(t.ok){const s=await t.json();u(`${g}/verify-account/${s.key}`,{replace:!0}),a(!1)}else{const s=await t.json();console.error("Verification failed:",s),o("Mã xác thực không chính xác. Vui lòng thử lại."),a(!1)}}catch(t){console.error("Error during verification:",t),a(!1)}},d=async()=>{const t=new FormData;t.append("otp",r);try{a(!0);const s=await fetch(`/api/verify-account/${i}`,{method:"POST",body:t,credentials:"include"});if(s.ok)window.location.href="/";else{const x=await s.json();console.error("Verification failed:",x),o("Mã xác thực không chính xác. Vui lòng thử lại."),a(!1)}}catch(s){console.error("Error during verification:",s),a(!1)}};return e.jsxs("div",{className:"flex flex-col flex-1 w-full overflow-y-auto lg:w-1/2 no-scrollbar",children:[e.jsx("div",{className:"w-full max-w-md mx-auto mb-5 sm:pt-10"}),e.jsxs("div",{className:"flex flex-col justify-center flex-1 w-full max-w-md mx-auto",children:[e.jsxs("div",{className:"mb-5 sm:mb-8",children:[e.jsx("h1",{className:"mb-2 font-semibold text-gray-800 text-title-sm dark:text-white/90 sm:text-title-md",children:"Xác thực tài khoản"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-white/70",children:"Chúng tôi vừa gửi một mã xác thực đến email của bạn. Vui lòng nhập mã gồm 6 chữ số bên dưới để tiếp tục."})]}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),d()},className:"space-y-4",children:[e.jsx(v,{disabled:l,placeholder:"Nhập mã OTP",maxLength:6,value:r,onChange:t=>m(t.target.value),required:!0}),c&&e.jsx("div",{className:"text-sm text-red-500",children:c}),e.jsx("button",{onClick:d,type:"submit",disabled:r.length!==6||l,className:"w-full px-4 py-3 text-sm font-medium text-white transition rounded-lg bg-brand-500 hover:bg-brand-600 disabled:opacity-50",children:"Xác nhận"}),e.jsxs("div",{className:"text-sm text-center text-gray-600 dark:text-white/70",children:["Không nhận được mã?"," ",e.jsx("button",{type:"button",className:"font-semibold text-brand-500 hover:underline",onClick:t=>{t.preventDefault(),h()},children:"Gửi lại mã"})]})]})]})]})}function A(){return e.jsxs(y,{children:[e.jsx(b,{title:"Verify Account",description:"Verify Account by OTP"}),e.jsx(j,{children:e.jsx(w,{})})]})}export{A as default};
