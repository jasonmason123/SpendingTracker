import{r as t,u as E,j as s,c as p,P as I}from"./index-DvfJ_ynl.js";import{P as L,A as R}from"./PublicRoute-CXzmJ905.js";import{L as f}from"./Label-COf6Fszm.js";import{I as g}from"./InputField--cIt_x2f.js";import{S as j,a as k}from"./eye-close-B9zm-Tfh.js";import{B as F}from"./Button-CVKNUHde.js";function K(){const[i,w]=t.useState(""),[o,b]=t.useState(!1),[n,N]=t.useState(!1),[a,d]=t.useState(!1),[r,h]=t.useState(!0),[c,m]=t.useState(!1),[y,v]=t.useState(!1),[u,x]=t.useState(null),{code:S}=E(),P=async()=>{if(!a&&r){const e=new FormData;e.append("value",i);try{m(!0);const l=await fetch(`/api/reset-password/${S}`,{method:"POST",body:e,credentials:"include"});if(l.ok)v(!0),setTimeout(()=>{window.location.href="/sign-in"},3e3);else{const z=await l.json();console.log("Failed to reset password:",z),x("Đã xảy ra lỗi. Vui lòng thử lại.")}}catch(l){console.log("Error resetting password",l),x("Đã xảy ra lỗi. Vui lòng thử lại.")}finally{m(!1)}}},M=e=>{!p(e)&&!a?d(!0):p(e)&&a&&d(!1),w(e)},C=e=>{e!==i&&r?h(!1):e===i&&!r&&h(!0)};return s.jsxs("div",{className:"flex flex-col flex-1 w-full overflow-y-auto lg:w-1/2 no-scrollbar",children:[s.jsx("div",{className:"w-full max-w-md mx-auto mb-5 sm:pt-10"}),s.jsxs("div",{className:"flex flex-col justify-center flex-1 w-full max-w-md mx-auto",children:[s.jsxs("div",{className:"mb-5 sm:mb-8",children:[s.jsx("h1",{className:"mb-2 font-semibold text-gray-800 text-title-sm dark:text-white/90 sm:text-title-md",children:"Khôi phục mật khẩu"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-white/70",children:"Nhập mật khẩu mới của bạn để khôi phục tài khoản. Mật khẩu phải có ít nhất 8 ký tự và bao gồm chữ hoa, chữ thường, số và ký tự đặc biệt."})]}),y?s.jsx("div",{className:"p-4 mb-4 text-sm text-green-800 bg-green-100 rounded-lg dark:bg-green-200 dark:text-green-800",role:"alert",children:s.jsx("span",{className:"font-medium",children:"Mật khẩu đã được khôi phục thành công. Bạn sẽ được chuyển hướng đến trang đăng nhập."})}):s.jsxs(s.Fragment,{children:[u&&s.jsx("div",{className:"p-4 mb-4 text-sm text-red-800 bg-red-100 rounded-lg dark:bg-red-200 dark:text-red-800",role:"alert",children:s.jsx("span",{className:"font-medium",children:u})}),s.jsxs("form",{className:"space-y-4",onSubmit:e=>{e.preventDefault(),P()},children:[s.jsxs("div",{children:[s.jsxs(f,{children:["Mật khẩu",s.jsx("span",{className:"text-error-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(g,{disabled:c,error:a,required:!0,placeholder:"Nhập mật khẩu của bạn",type:o?"text":"password",onChange:e=>M(e.target.value)}),s.jsx("span",{onClick:()=>b(!o),className:"absolute z-30 -translate-y-1/2 cursor-pointer right-4 top-1/2",children:o?s.jsx(j,{className:"fill-gray-500 dark:fill-gray-400 size-5"}):s.jsx(k,{className:"fill-gray-500 dark:fill-gray-400 size-5"})})]}),a&&s.jsx("p",{className:"mt-2 text-sm text-red-500 dark:text-red-400",children:"Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa, chữ thường, số và ký tự đặc biệt."})]}),s.jsxs("div",{children:[s.jsxs(f,{children:["Nhập lại mật khẩu",s.jsx("span",{className:"text-error-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(g,{disabled:c,error:!r,required:!0,placeholder:"Nhập lại mật khẩu của bạn",type:n?"text":"password",onChange:e=>C(e.target.value)}),s.jsx("span",{onClick:()=>N(!n),className:"absolute z-30 -translate-y-1/2 cursor-pointer right-4 top-1/2",children:n?s.jsx(j,{className:"fill-gray-500 dark:fill-gray-400 size-5"}):s.jsx(k,{className:"fill-gray-500 dark:fill-gray-400 size-5"})})]}),!r&&s.jsx("p",{className:"mt-2 text-sm text-red-500 dark:text-red-400",children:"Mật khẩu không khớp. Vui lòng thử lại."})]}),s.jsx("div",{children:s.jsx(F,{className:"w-full",size:"sm",type:"submit",disabled:c,children:"Khôi phục mật khẩu"})})]})]})]})]})}function O(){return s.jsxs(L,{children:[s.jsx(I,{title:"Khôi phục mật khẩu",description:"Khôi phục mật khẩu tài khoản của bạn"}),s.jsx(R,{children:s.jsx(K,{})})]})}export{O as default};
