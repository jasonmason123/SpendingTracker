import{a as g,u as b,r,j as t,A as y,P as p}from"./index-BRHPLc3Q.js";import{P as v,A as j}from"./PublicRoute-Cybp9x-F.js";import{I as w}from"./InputField-0YEEKdm4.js";import{a as d}from"./AuthenticationApiCaller-Dgk2bYhZ.js";function k(){const{confirmationToken:o}=g(),h=b(),c=6,[s,x]=r.useState(""),[l,n]=r.useState(null),[m,a]=r.useState(!1),f=async()=>{try{a(!0),await d.resendCode(o).then(async e=>{if(e.ok){const i=await e.json();h(`/verify-account/${i.confirmationToken}`,{replace:!0}),a(!1)}else{const i=await e.json();console.error("Verification failed:",i),n("Có lỗi khi gửi lại mã xác thực. Vui lòng thử lại sau.")}})}catch(e){console.error("Error during verification:",e),n("Có lỗi khi gửi lại mã xác thực. Vui lòng thử lại sau.")}finally{a(!1)}},u=async()=>{try{a(!0),await d.verifyAccount(o,s).then(async e=>{if(e.ok)window.location.href=y;else{const i=await e.text();console.error("Verification failed:",i),n("Mã xác thực không chính xác. Vui lòng thử lại.")}})}catch(e){console.error("Error during verification:",e),n("Có lỗi khi xác thực. Vui lòng thử lại sau.")}finally{a(!1)}};return t.jsxs("div",{className:"flex flex-col flex-1 w-full overflow-y-auto lg:w-1/2 no-scrollbar",children:[t.jsx("div",{className:"w-full max-w-md mx-auto mb-5 sm:pt-10"}),t.jsxs("div",{className:"flex flex-col justify-center flex-1 w-full max-w-md mx-auto",children:[t.jsxs("div",{className:"mb-5 sm:mb-8",children:[t.jsx("h1",{className:"mb-2 font-semibold text-gray-800 text-title-sm dark:text-white/90 sm:text-title-md",children:"Xác thực tài khoản"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-white/70",children:'Chúng tôi vừa gửi một mã xác thực 6 chữ số đến email của bạn. Vui lòng nhập mã vào bên dưới và ấn "Xác nhận" để tiếp tục.'})]}),t.jsxs("form",{onSubmit:e=>{e.preventDefault(),u()},className:"space-y-4",children:[t.jsx(w,{disabled:m,placeholder:"Nhập mã OTP",type:"number",maxLength:c,value:s,onChange:e=>x(e.target.value),required:!0}),l&&t.jsx("div",{className:"text-sm text-red-500",children:l}),t.jsx("button",{onClick:u,type:"submit",disabled:s.length!==c||m,className:"w-full px-4 py-3 text-sm font-medium text-white transition rounded-lg bg-brand-500 hover:bg-brand-600 disabled:opacity-50",children:"Xác nhận"}),t.jsxs("div",{className:"text-sm text-center text-gray-600 dark:text-white/70",children:["Không nhận được mã?"," ",t.jsx("button",{type:"button",className:"font-semibold text-brand-500 hover:underline",onClick:e=>{e.preventDefault(),f()},children:"Gửi lại mã"})]})]})]})]})}function P(){return t.jsxs(v,{children:[t.jsx(p,{title:"Verify Account",description:"Verify Account by OTP"}),t.jsx(j,{children:t.jsx(k,{})})]})}export{P as default};
