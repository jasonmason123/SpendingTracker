import{u as p,a as f,f as x,r as l,j as a,P as y}from"./index-BRHPLc3Q.js";import{P as b}from"./PageBreadCrumb-DfFkRX6n.js";import{I as j}from"./InputField-0YEEKdm4.js";import{B as v}from"./Button-t0aZ2z4g.js";import{b as C,u as N,c as E}from"./CategoryApiCaller-CDAWkfrK.js";function I(){var m;const g=p(),{id:e}=f(),c=(m=x().state)==null?void 0:m.category,[d,n]=l.useState(!1),[t,i]=l.useState();async function h(r){var o;if(r.preventDefault(),!!((o=t==null?void 0:t.name)!=null&&o.trim())&&confirm("Bạn có chắc chắn muốn lưu?"))try{n(!0);let s;e?s=await N({...t,id:parseInt(e)}):s=await E({name:t.name.trim()}),alert("Đã lưu danh mục thành công!");const u=s.id?`/categories/${s.id}`:e?`/categories/${e}`:"/categories";g(u)}catch(s){console.error("Error saving category:",s)}finally{n(!1)}}return l.useEffect(()=>{c&&e?i(c):!c&&e?(n(!0),C(parseInt(e)).then(r=>i(r)).catch(r=>console.error("Error fetching category:",r)).finally(()=>n(!1))):i({name:""})},[e]),a.jsxs(a.Fragment,{children:[a.jsx(y,{title:e?"Cập nhật danh mục":"Tạo danh mục mới",description:e?"Cập nhật danh mục":"Tạo danh mục mới"}),a.jsx(b,{pageTitles:[{title:"Danh mục",path:"/categories"},{title:e?"Cập nhật":"Tạo mới",path:e?`/categories/${e}/edit`:"/categories/add"}]}),a.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 dark:border-gray-800 dark:bg-white/[0.03] lg:p-6",children:[a.jsx("h3",{className:"mb-5 text-lg font-semibold text-gray-800 dark:text-white/90 lg:mb-7",children:e?"Cập nhật danh mục":"Tạo danh mục mới"}),a.jsxs("form",{className:"space-y-6",onSubmit:h,children:[a.jsx("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2 lg:gap-7",children:a.jsxs("div",{children:[a.jsxs("p",{className:"mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400",children:["Tên danh mục ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(j,{required:!0,disabled:d,placeholder:"VD: Ăn uống",maxLength:100,value:(t==null?void 0:t.name)||"",onChange:r=>i(o=>({...o||{},name:r.target.value}))})]})}),a.jsx("div",{className:"flex justify-end gap-4",children:a.jsx(v,{size:"sm",type:"submit",disabled:d,children:"Lưu"})})]})]})]})}export{I as default};
