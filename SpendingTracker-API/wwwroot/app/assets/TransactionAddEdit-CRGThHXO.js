import{u as j,a as y,f as N,r as c,R as b,j as e,P as v,T as h}from"./index-BLYaz1Ly.js";import{P as k}from"./PageBreadCrumb-Ft2e30eZ.js";import{S as C}from"./Select-CIkTT0-R.js";import{B as T}from"./Button-vG6I2VUv.js";import{I as o}from"./InputField-DLym2q6P.js";import{D as E}from"./date-picker-D-EmgsaE.js";import{a as w,u as D,c as P}from"./TransactionApiCaller-C_QI238I.js";import"./Label-FMJtuZap.js";const S=[{value:h.INCOME+"",label:"Thu nhập"},{value:h.EXPENSE+"",label:"Chi tiêu"}];function O(){var x,g;const m=j(),{id:r}=y(),d=(x=N().state)==null?void 0:x.transaction,[l,n]=c.useState(!1),[a,i]=c.useState(),u=b.useRef(null),p=async t=>{if(t.preventDefault(),a)try{n(!0);let s={};r?s=await D(a):s=await P(a),alert("Đã lưu giao dịch thành công!");const f=s.id?`/transactions/${s.id}`:r?`/transactions/${r}`:"/transactions";m(f)}catch(s){console.error("Error saving transaction:",s)}finally{n(!1)}};return c.useEffect(()=>{d&&r?i(d):!d&&r&&w(parseInt(r)).then(t=>{i({...t,date:t.date&&new Date(t.date),createdAt:t.createdAt&&new Date(t.createdAt),updatedAt:t.updatedAt&&new Date(t.updatedAt)})}).catch(t=>{console.error("Error fetching transaction:",t)}).finally(()=>{n(!1)})},[]),e.jsxs(e.Fragment,{children:[e.jsx(v,{title:r?"Cập nhật giao dịch":"Tạo giao dịch mới",description:r?"Cập nhật giao dịch":"Tạo giao dịch mới"}),e.jsx(k,{pageTitles:[{title:"Giao dịch",path:"/transactions"},{title:r?"Cập nhật giao dịch":"Tạo giao dịch mới",path:r?`/transactions/${r}/edit`:"/transactions/create"}]}),e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 dark:border-gray-800 dark:bg-white/[0.03] lg:p-6",children:[e.jsx("h3",{className:"mb-5 text-lg font-semibold text-gray-800 dark:text-white/90 lg:mb-7",children:r?"Cập nhật giao dịch":"Tạo giao dịch mới"}),e.jsxs("form",{className:"space-y-6",onSubmit:p,children:[e.jsx("div",{className:"p-5 border border-gray-200 rounded-2xl dark:border-gray-800 lg:p-6",children:e.jsx("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-start lg:justify-between",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white/90 lg:mb-6",children:r?`Mã giao dịch: ${r}`:"Thông tin giao dịch"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3 lg:gap-7 2xl:gap-x-32",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400",children:["Mô tả ngắn",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("p",{className:"text-sm font-medium text-gray-800 dark:text-white/90",children:e.jsx(o,{required:!0,disabled:l,placeholder:"VD: Đi ăn ngoài",maxLength:40,value:(a==null?void 0:a.description)||"",onChange:t=>i(s=>({...s,description:t.target.value}))})})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400",children:["Bên giao dịch",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"text-sm font-medium text-gray-800 dark:text-white/90",children:e.jsx(o,{disabled:l,placeholder:"Người, tổ chức giao dịch",required:!0,value:(a==null?void 0:a.merchant)||"",onChange:t=>i(s=>({...s,merchant:t.target.value}))})})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400",children:["Ngày",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"text-sm font-medium text-gray-800 dark:text-white/90",children:e.jsx(E,{id:"date",mode:"single",required:!0,disabled:l,defaultDate:(a==null?void 0:a.date)||void 0,confirmOnly:!1,onChange:t=>{t&&t[0]&&i(s=>({...s,date:t[0]}))},placeholder:"Ngày giao dịch",instanceRef:t=>u.current=t})})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400",children:["Loại giao dịch",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"text-sm font-medium text-gray-800 dark:text-white/90",children:e.jsx(C,{required:!0,disabled:l,placeholder:"Chọn loại giao dịch",options:S,defaultValue:(g=d==null?void 0:d.transactionType)==null?void 0:g.toString(),onChange:t=>{i(s=>({...s,transactionType:t}))}})})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400",children:[a&&a.transactionType==h.INCOME?"Khoản nhận về (VNĐ)":"Khoản đã chi (VNĐ)",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("p",{className:"text-sm font-medium text-gray-800 dark:text-white/90",children:e.jsx(o,{required:!0,disabled:l,placeholder:1e4.toLocaleString("vi-VN",{style:"currency",currency:"VND"}),type:"number",value:(a==null?void 0:a.amount)||"",onChange:t=>i(s=>({...s,amount:parseFloat(t.target.value)}))})})]})]})]})})}),e.jsx("div",{className:"flex justify-end gap-4",children:e.jsx(T,{size:"sm",type:"submit",disabled:l,children:"Lưu"})})]})]})]})}export{O as default};
