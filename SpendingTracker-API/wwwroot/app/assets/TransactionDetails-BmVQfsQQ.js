import{j as e,T as s,F as f,r as c,a as y,P as b}from"./index-DSvhOJjZ.js";import{P as v}from"./PageBreadCrumb-CAfprJDx.js";import{u as w,M as k}from"./index-3iqQv5Cj.js";import{B as m}from"./Button-BqH1kbbd.js";import{I as T}from"./InputField-PT46ou2s.js";import{L as E}from"./Label-ClBgApu8.js";import{B as x}from"./Badge-CRAhvlJE.js";import{C}from"./ComponentCard-CqZdaD4X.js";import"./index-Dn9UBO8D.js";function S({transaction:a}){return e.jsx("div",{className:"p-5 border border-gray-200 rounded-2xl dark:border-gray-800 lg:p-6",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-10 h-10 flex items-center justify-center rounded-full border
              ${a.transactionType===s.INCOME?"border-green-500":a.transactionType===s.EXPENSE?"border-red-500":""}`,children:a.transactionType===s.INCOME?e.jsx("i",{className:"fa-solid fa-circle-dollar-to-slot text-green-500"}):a.transactionType===s.EXPENSE?e.jsx("i",{className:"fa-solid fa-wallet text-red-500"}):null}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[e.jsx("div",{className:"text-lg font-bold",children:a.description}),e.jsx("div",{className:"text-sm text-gray-400",children:e.jsx("b",{children:a.date&&a.date.toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"})})})]})]}),e.jsx("div",{children:e.jsxs("span",{className:`text-lg font-bold
              ${a.amount&&a.amount<0?"text-red-500":a.amount&&a.amount>0?"text-green-500":"text-gray-500"}`,children:[a.amount!==void 0&&a.amount>0?"+":"",a.amount&&a.amount.toLocaleString("vi-VN",{style:"currency",currency:"VND"})]})})]})})}function D({entity:a}){var t;return e.jsx("div",{className:"p-5 border border-gray-200 rounded-2xl dark:border-gray-800 lg:p-6",children:e.jsx("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-start lg:justify-between",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white/90 mb-6",children:"Thông tin khác"}),e.jsxs("div",{className:"lg:flex grid grid-cols-1 gap-4 lg:grid-cols-2 lg:gap-7 2xl:gap-x-32",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400",children:"Được tạo vào ngày"}),e.jsx("p",{className:"text-sm font-bold text-gray-800 dark:text-white/90",children:(a==null?void 0:a.dateCreated)&&new Date(a.dateCreated).toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"})})]}),a.dateUpdated&&e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400",children:"Lần cập nhật gần nhất"}),e.jsx("p",{className:"text-sm font-bold text-gray-800 dark:text-white/90",children:(t=a==null?void 0:a.dateUpdated)==null?void 0:t.toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"})})]}),a.flagDel!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400",children:"Trạng thái hoạt động"}),e.jsx("p",{className:"text-sm font-medium text-gray-800 dark:text-white/90",children:(a==null?void 0:a.flagDel)==f.FALSE?e.jsx(x,{color:"success",size:"sm",children:"Đang hoạt động"}):e.jsx(x,{color:"error",size:"sm",children:"Đã ngừng hoạt động"})})]})]})]})})})}function M({transaction:a}){return e.jsx("div",{className:"p-5 border border-gray-200 rounded-2xl dark:border-gray-800 lg:p-6",children:e.jsx("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-start lg:justify-between",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white/90 mb-6",children:"Thông tin chung"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3 lg:gap-7 2xl:gap-x-32",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400",children:"Tài khoản nguồn"}),e.jsx("p",{className:"text-sm font-bold text-gray-800 dark:text-white/90",children:a==null?void 0:a.merchant})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400",children:a.transactionType===s.INCOME&&a.amount&&a.amount>0?"Khoản nhận về":"Khoản đã chi"}),e.jsx("p",{className:"text-sm font-bold text-gray-800 dark:text-white/90 text-bold",children:a.amount&&a.amount>0?e.jsxs("span",{className:"text-green-500",children:["+",a.amount.toLocaleString("vi-VN",{style:"currency",currency:"VND"})]}):a.amount&&a.amount<0?e.jsx("span",{className:"text-red-500",children:a.amount.toLocaleString("vi-VN",{style:"currency",currency:"VND"})}):e.jsxs("span",{className:"text-gray-500",children:[a.amount," VNĐ"]})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400",children:"Loại giao dịch"}),e.jsx("p",{className:"text-sm font-bold text-gray-800 dark:text-white/90",children:e.jsx(x,{size:"sm",className:a.transactionType===s.INCOME?"border-green-500":a.transactionType===s.EXPENSE?"border-red-500":"",children:a.transactionType===s.INCOME?"Thu nhập":a.transactionType===s.EXPENSE?"Chi tiêu":null})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400",children:"Đối tác giao dịch"}),e.jsx("p",{className:"text-sm font-bold text-gray-800 dark:text-white/90",children:a==null?void 0:a.merchant})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400",children:"Khoản"}),e.jsx("p",{className:"text-sm font-bold text-gray-800 dark:text-white/90",children:a.transactionType===s.INCOME?"Thu nhập":a.transactionType===s.EXPENSE?"Chi tiêu":null})]})]})]})})})}function L({transaction:a}){return e.jsx("div",{className:"p-5 border border-gray-200 rounded-2xl dark:border-gray-800 lg:p-6",children:e.jsx("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-start lg:justify-between",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white/90 mb-6",children:"Ghi chú"}),e.jsx("div",{className:"text-gray-800 dark:text-white/90",children:a.note?a.note:e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Không có ghi chú"})})]})})})}function P({transaction:a}){const{attachmentUrl:t}=a,r=/\.(jpg|jpeg|png|gif|webp)$/i.test(t||""),i=/\.pdf$/i.test(t||"");return e.jsx("div",{className:"p-5 border border-gray-200 rounded-2xl dark:border-gray-800 lg:p-6",children:e.jsx("div",{className:"gap-6 lg:flex-row lg:items-start lg:justify-between",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white/90 mb-6",children:"Tệp đính kèm"}),t?e.jsxs("div",{className:"rounded-xl overflow-hidden",children:[r&&e.jsx("img",{src:t,alt:"Attachment",className:"max-w-full h-auto rounded-md border"}),i&&e.jsx("iframe",{src:t,title:"PDF Attachment",className:"w-full h-96 rounded-md border"}),!r&&!i&&e.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"Xem tệp đính kèm"})]}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Không có tệp đính kèm"})]})})})}function z(){const[a,t]=c.useState(!1),[r,i]=c.useState({}),{isOpen:g,openModal:h,closeModal:o}=w(),p=()=>{console.log("Saving changes..."),o()},{id:n}=y(),[j,u]=c.useState(n||""),N=async()=>{try{t(!0);const l=await fetch(`/api/transactions/${n}`,{method:"GET",credentials:"include"});if(!l.ok)throw new Error("Network response was not ok");const d=await l.json();i({...d,date:new Date(d.dateRecorded),createdAt:new Date(d.dateCreated),dateUpdated:d.dateUpdated&&new Date(d.dateUpdated)}),console.log("Transaction data fetched:",d)}catch(l){console.error("Error fetching account data:",l)}finally{t(!1)}};return c.useEffect(()=>{N()},[]),e.jsxs(e.Fragment,{children:[e.jsx(b,{title:"Giao dịch",description:"Giao dịch tài chính"}),e.jsx(v,{pageTitles:[{title:"Giao dịch",path:"/transactions"},{title:"Chi tiết giao dịch",path:`/transactions/${n}`}]}),e.jsx("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 dark:border-gray-800 dark:bg-white/[0.03] lg:p-6",children:e.jsx("div",{className:"space-y-6",children:a?e.jsx("p",{className:"text-center text-gray-500 dark:text-white/50",children:"Đang tải dữ liệu..."}):e.jsxs(C,{title:"Chi tiết giao dịch",actions:[{actionName:"Cập nhật",action:h,icon:e.jsx("i",{className:"fa-solid fa-pencil"})}],children:[e.jsx(S,{transaction:r}),e.jsx(M,{transaction:r}),e.jsx(P,{transaction:r}),e.jsx(L,{transaction:r}),e.jsx(D,{entity:r})]})})}),e.jsx(k,{isOpen:g,onClose:o,className:"max-w-[700px] m-4",children:e.jsxs("div",{className:"relative w-full p-4 overflow-y-auto bg-white no-scrollbar rounded-3xl dark:bg-gray-900 lg:p-11",children:[e.jsx("div",{className:"px-2 pr-14",children:e.jsxs("h4",{className:"mb-6 text-2xl font-semibold text-gray-800 dark:text-white/90",children:["Cập nhật thông tin tài khoản: ",n]})}),e.jsxs("form",{className:"flex flex-col",children:[e.jsx("div",{className:"px-2 overflow-y-auto custom-scrollbar",children:e.jsx("div",{className:"gap-x-6 gap-y-5 lg:grid-cols-2",children:e.jsxs("div",{children:[e.jsx(E,{children:"Tên tài khoản"}),e.jsx(T,{type:"text",value:j,onChange:l=>u(l.target.value)})]})})}),e.jsxs("div",{className:"flex items-center gap-3 px-2 mt-6 lg:justify-end",children:[e.jsx(m,{size:"sm",variant:"outline",onClick:o,children:"Hủy"}),e.jsx(m,{size:"sm",onClick:p,children:"Lưu"})]})]})]})})]})}export{z as default};
